{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\thech\\\\Documents\\\\Summer 2022\\\\Headstart\\\\GroupCollab\\\\client\\\\src\\\\component\\\\Videochat.jsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { useRef, useState } from \"react\";\nimport { ReactComponent as HangupIcon } from \"./icons/hangup.svg\";\nimport { ReactComponent as MoreIcon } from \"./icons/more-vertical.svg\";\nimport { ReactComponent as CopyIcon } from \"./icons/copy.svg\"; // Initialize Firebase\n\nimport { firestore } from \"../backend/firebase\";\nimport { pc } from \"../backend/stun\"; // Initialize WebRTC\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Videochat() {\n  _s();\n\n  const [currentPage, setCurrentPage] = useState(\"home\");\n  const [joinCode, setJoinCode] = useState(\"\");\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app\",\n    children: [\"aaa aa\", currentPage === \"home\" ? /*#__PURE__*/_jsxDEV(Menu, {\n      joinCode: joinCode,\n      setJoinCode: setJoinCode,\n      setPage: setCurrentPage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 22,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(Videos, {\n      mode: currentPage,\n      callId: joinCode,\n      setPage: setCurrentPage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 19,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Videochat, \"IW+AHA0YXjXbTIexrqUDCSkt3LE=\");\n\n_c = Videochat;\n\nfunction Menu(_ref) {\n  let {\n    joinCode,\n    setJoinCode,\n    setPage\n  } = _ref;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"home\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"create box\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setPage(\"create\"),\n        children: \"Create Call\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"answer box\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        value: joinCode,\n        onChange: e => setJoinCode(e.target.value),\n        placeholder: \"Join with code\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setPage(\"join\"),\n        children: \"Answer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 36,\n    columnNumber: 5\n  }, this);\n}\n\n_c2 = Menu;\n\nfunction Videos(_ref2) {\n  _s2();\n\n  let {\n    mode,\n    callId,\n    setPage\n  } = _ref2;\n  const [webcamActive, setWebcamActive] = useState(false);\n  const [roomId, setRoomId] = useState(callId);\n  const localRef = useRef();\n  const remoteRef = useRef();\n\n  const setupSources = async () => {\n    const localStream = await navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true\n    });\n    const remoteStream = new MediaStream();\n    localStream.getTracks().forEach(track => {\n      pc.addTrack(track, localStream);\n    });\n\n    pc.ontrack = event => {\n      event.streams[0].getTracks().forEach(track => {\n        remoteStream.addTrack(track);\n      });\n    };\n\n    localRef.current.srcObject = localStream;\n    remoteRef.current.srcObject = remoteStream;\n    setWebcamActive(true);\n\n    if (mode === \"create\") {\n      const callDoc = firestore.collection(\"calls\").doc();\n      const offerCandidates = callDoc.collection(\"offerCandidates\");\n      const answerCandidates = callDoc.collection(\"answerCandidates\");\n      setRoomId(callDoc.id);\n\n      pc.onicecandidate = event => {\n        event.candidate && offerCandidates.add(event.candidate.toJSON());\n      };\n\n      const offerDescription = await pc.createOffer();\n      await pc.setLocalDescription(offerDescription);\n      const offer = {\n        sdp: offerDescription.sdp,\n        type: offerDescription.type\n      };\n      await callDoc.set({\n        offer\n      });\n      callDoc.onSnapshot(snapshot => {\n        const data = snapshot.data();\n\n        if (!pc.currentRemoteDescription && data !== null && data !== void 0 && data.answer) {\n          const answerDescription = new RTCSessionDescription(data.answer);\n          pc.setRemoteDescription(answerDescription);\n        }\n      });\n      answerCandidates.onSnapshot(snapshot => {\n        snapshot.docChanges().forEach(change => {\n          if (change.type === \"added\") {\n            const candidate = new RTCIceCandidate(change.doc.data());\n            pc.addIceCandidate(candidate);\n          }\n        });\n      });\n    } else if (mode === \"join\") {\n      const callDoc = firestore.collection(\"calls\").doc(callId);\n      const answerCandidates = callDoc.collection(\"answerCandidates\");\n      const offerCandidates = callDoc.collection(\"offerCandidates\");\n\n      pc.onicecandidate = event => {\n        event.candidate && answerCandidates.add(event.candidate.toJSON());\n      };\n\n      const callData = (await callDoc.get()).data();\n      const offerDescription = callData.offer;\n      await pc.setRemoteDescription(new RTCSessionDescription(offerDescription));\n      const answerDescription = await pc.createAnswer();\n      await pc.setLocalDescription(answerDescription);\n      const answer = {\n        type: answerDescription.type,\n        sdp: answerDescription.sdp\n      };\n      await callDoc.update({\n        answer\n      });\n      offerCandidates.onSnapshot(snapshot => {\n        snapshot.docChanges().forEach(change => {\n          if (change.type === \"added\") {\n            let data = change.doc.data();\n            pc.addIceCandidate(new RTCIceCandidate(data));\n          }\n        });\n      });\n    }\n\n    pc.onconnectionstatechange = event => {\n      if (pc.connectionState === \"disconnected\") {\n        hangUp();\n      }\n    };\n  };\n\n  const hangUp = async () => {\n    pc.close();\n\n    if (roomId) {\n      let roomRef = firestore.collection(\"calls\").doc(roomId);\n      await roomRef.collection(\"answerCandidates\").get().then(querySnapshot => {\n        querySnapshot.forEach(doc => {\n          doc.ref.delete();\n        });\n      });\n      await roomRef.collection(\"offerCandidates\").get().then(querySnapshot => {\n        querySnapshot.forEach(doc => {\n          doc.ref.delete();\n        });\n      });\n      await roomRef.delete();\n    }\n\n    window.location.reload();\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"videos\",\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      ref: localRef,\n      autoPlay: true,\n      playsInline: true,\n      className: \"bg-green-300\",\n      muted: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      ref: remoteRef,\n      autoPlay: true,\n      playsInline: true,\n      className: \"bg-red-300\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: hangUp,\n        disabled: !webcamActive,\n        className: \" \",\n        children: /*#__PURE__*/_jsxDEV(HangupIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        tabIndex: 0,\n        role: \"button\",\n        className: \" \",\n        children: [roomId, /*#__PURE__*/_jsxDEV(MoreIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              navigator.clipboard.writeText(roomId);\n            },\n            children: [/*#__PURE__*/_jsxDEV(CopyIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 15\n            }, this), \" Copy joining code\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 7\n    }, this), !webcamActive && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Turn on your camera and microphone and start the call\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setPage(\"home\"),\n            className: \"\",\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: setupSources,\n            children: \"Start\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 191,\n    columnNumber: 5\n  }, this);\n}\n\n_s2(Videos, \"Ie/qGXpq8E8VsIynTPqhiYB51aw=\");\n\n_c3 = Videos;\nexport default Videochat;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"Videochat\");\n$RefreshReg$(_c2, \"Menu\");\n$RefreshReg$(_c3, \"Videos\");","map":{"version":3,"names":["useRef","useState","ReactComponent","HangupIcon","MoreIcon","CopyIcon","firestore","pc","Videochat","currentPage","setCurrentPage","joinCode","setJoinCode","Menu","setPage","e","target","value","Videos","mode","callId","webcamActive","setWebcamActive","roomId","setRoomId","localRef","remoteRef","setupSources","localStream","navigator","mediaDevices","getUserMedia","video","audio","remoteStream","MediaStream","getTracks","forEach","track","addTrack","ontrack","event","streams","current","srcObject","callDoc","collection","doc","offerCandidates","answerCandidates","id","onicecandidate","candidate","add","toJSON","offerDescription","createOffer","setLocalDescription","offer","sdp","type","set","onSnapshot","snapshot","data","currentRemoteDescription","answer","answerDescription","RTCSessionDescription","setRemoteDescription","docChanges","change","RTCIceCandidate","addIceCandidate","callData","get","createAnswer","update","onconnectionstatechange","connectionState","hangUp","close","roomRef","then","querySnapshot","ref","delete","window","location","reload","clipboard","writeText"],"sources":["C:/Users/thech/Documents/Summer 2022/Headstart/GroupCollab/client/src/component/Videochat.jsx"],"sourcesContent":["import { useRef, useState } from \"react\";\r\n\r\nimport { ReactComponent as HangupIcon } from \"./icons/hangup.svg\";\r\nimport { ReactComponent as MoreIcon } from \"./icons/more-vertical.svg\";\r\nimport { ReactComponent as CopyIcon } from \"./icons/copy.svg\";\r\n\r\n// Initialize Firebase\r\n\r\nimport { firestore } from \"../backend/firebase\";\r\nimport { pc } from \"../backend/stun\";\r\n\r\n// Initialize WebRTC\r\n\r\nfunction Videochat() {\r\n  const [currentPage, setCurrentPage] = useState(\"home\");\r\n  const [joinCode, setJoinCode] = useState(\"\");\r\n\r\n  return (\r\n    <div className=\"app\">\r\n      aaa aa\r\n      {currentPage === \"home\" ? (\r\n        <Menu\r\n          joinCode={joinCode}\r\n          setJoinCode={setJoinCode}\r\n          setPage={setCurrentPage}\r\n        />\r\n      ) : (\r\n        <Videos mode={currentPage} callId={joinCode} setPage={setCurrentPage} />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction Menu({ joinCode, setJoinCode, setPage }) {\r\n  return (\r\n    <div className=\"home\">\r\n      <div className=\"create box\">\r\n        <button onClick={() => setPage(\"create\")}>Create Call</button>\r\n      </div>\r\n\r\n      <div className=\"answer box\">\r\n        <input\r\n          value={joinCode}\r\n          onChange={(e) => setJoinCode(e.target.value)}\r\n          placeholder=\"Join with code\"\r\n        />\r\n        <button onClick={() => setPage(\"join\")}>Answer</button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction Videos({ mode, callId, setPage }) {\r\n  const [webcamActive, setWebcamActive] = useState(false);\r\n  const [roomId, setRoomId] = useState(callId);\r\n\r\n  const localRef = useRef();\r\n  const remoteRef = useRef();\r\n\r\n  const setupSources = async () => {\r\n    const localStream = await navigator.mediaDevices.getUserMedia({\r\n      video: true,\r\n      audio: true,\r\n    });\r\n    const remoteStream = new MediaStream();\r\n\r\n    localStream.getTracks().forEach((track) => {\r\n      pc.addTrack(track, localStream);\r\n    });\r\n\r\n    pc.ontrack = (event) => {\r\n      event.streams[0].getTracks().forEach((track) => {\r\n        remoteStream.addTrack(track);\r\n      });\r\n    };\r\n\r\n    localRef.current.srcObject = localStream;\r\n    remoteRef.current.srcObject = remoteStream;\r\n\r\n    setWebcamActive(true);\r\n\r\n    if (mode === \"create\") {\r\n      const callDoc = firestore.collection(\"calls\").doc();\r\n      const offerCandidates = callDoc.collection(\"offerCandidates\");\r\n      const answerCandidates = callDoc.collection(\"answerCandidates\");\r\n\r\n      setRoomId(callDoc.id);\r\n\r\n      pc.onicecandidate = (event) => {\r\n        event.candidate && offerCandidates.add(event.candidate.toJSON());\r\n      };\r\n\r\n      const offerDescription = await pc.createOffer();\r\n      await pc.setLocalDescription(offerDescription);\r\n\r\n      const offer = {\r\n        sdp: offerDescription.sdp,\r\n        type: offerDescription.type,\r\n      };\r\n\r\n      await callDoc.set({ offer });\r\n\r\n      callDoc.onSnapshot((snapshot) => {\r\n        const data = snapshot.data();\r\n        if (!pc.currentRemoteDescription && data?.answer) {\r\n          const answerDescription = new RTCSessionDescription(data.answer);\r\n          pc.setRemoteDescription(answerDescription);\r\n        }\r\n      });\r\n\r\n      answerCandidates.onSnapshot((snapshot) => {\r\n        snapshot.docChanges().forEach((change) => {\r\n          if (change.type === \"added\") {\r\n            const candidate = new RTCIceCandidate(change.doc.data());\r\n            pc.addIceCandidate(candidate);\r\n          }\r\n        });\r\n      });\r\n    } else if (mode === \"join\") {\r\n      const callDoc = firestore.collection(\"calls\").doc(callId);\r\n      const answerCandidates = callDoc.collection(\"answerCandidates\");\r\n      const offerCandidates = callDoc.collection(\"offerCandidates\");\r\n\r\n      pc.onicecandidate = (event) => {\r\n        event.candidate && answerCandidates.add(event.candidate.toJSON());\r\n      };\r\n\r\n      const callData = (await callDoc.get()).data();\r\n\r\n      const offerDescription = callData.offer;\r\n      await pc.setRemoteDescription(\r\n        new RTCSessionDescription(offerDescription)\r\n      );\r\n\r\n      const answerDescription = await pc.createAnswer();\r\n      await pc.setLocalDescription(answerDescription);\r\n\r\n      const answer = {\r\n        type: answerDescription.type,\r\n        sdp: answerDescription.sdp,\r\n      };\r\n\r\n      await callDoc.update({ answer });\r\n\r\n      offerCandidates.onSnapshot((snapshot) => {\r\n        snapshot.docChanges().forEach((change) => {\r\n          if (change.type === \"added\") {\r\n            let data = change.doc.data();\r\n            pc.addIceCandidate(new RTCIceCandidate(data));\r\n          }\r\n        });\r\n      });\r\n    }\r\n\r\n    pc.onconnectionstatechange = (event) => {\r\n      if (pc.connectionState === \"disconnected\") {\r\n        hangUp();\r\n      }\r\n    };\r\n  };\r\n\r\n  const hangUp = async () => {\r\n    pc.close();\r\n\r\n    if (roomId) {\r\n      let roomRef = firestore.collection(\"calls\").doc(roomId);\r\n      await roomRef\r\n        .collection(\"answerCandidates\")\r\n        .get()\r\n        .then((querySnapshot) => {\r\n          querySnapshot.forEach((doc) => {\r\n            doc.ref.delete();\r\n          });\r\n        });\r\n      await roomRef\r\n        .collection(\"offerCandidates\")\r\n        .get()\r\n        .then((querySnapshot) => {\r\n          querySnapshot.forEach((doc) => {\r\n            doc.ref.delete();\r\n          });\r\n        });\r\n\r\n      await roomRef.delete();\r\n    }\r\n\r\n    window.location.reload();\r\n  };\r\n\r\n  return (\r\n    <div className=\"videos\">\r\n      <video\r\n        ref={localRef}\r\n        autoPlay\r\n        playsInline\r\n        className=\"bg-green-300\"\r\n        muted\r\n      />\r\n      <video ref={remoteRef} autoPlay playsInline className=\"bg-red-300\" />\r\n\r\n      <div className=\"\">\r\n        <button onClick={hangUp} disabled={!webcamActive} className=\" \">\r\n          <HangupIcon />\r\n        </button>\r\n        <div tabIndex={0} role=\"button\" className=\" \">\r\n          {roomId}\r\n          <MoreIcon />\r\n          <div className=\"\">\r\n            <button\r\n              onClick={() => {\r\n                navigator.clipboard.writeText(roomId);\r\n              }}\r\n            >\r\n              <CopyIcon /> Copy joining code\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {!webcamActive && (\r\n        <div className=\"\">\r\n          <div className=\"\">\r\n            <h3>Turn on your camera and microphone and start the call</h3>\r\n            <div className=\"\">\r\n              <button onClick={() => setPage(\"home\")} className=\"\">\r\n                Cancel\r\n              </button>\r\n              <button onClick={setupSources}>Start</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Videochat;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}